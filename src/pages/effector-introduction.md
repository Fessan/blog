## Введение

У нас прошел воркшоп, на котором было множество вопросов. Я решил собрать их все вместе и поэтапно ответить на них. Будет интересно начинающим: мы разберем что такое реактивность и какие проблемы она решает, познакомимся с эффектором с нуля. Опытным разработчикам тоже будет интересно: поговорим про проблемы реактивности (в частности в Rx.js), причем тут графы, и немного про архитектуру.

## План

- Использованные ресуры: что такое CSSSR.school, комьюнити эффектора
  - [Канал](https://www.youtube.com/channel/UCdkZ6ckHOJ3DjAYxoGeMG0w/videos)
  - [RU чат эффектора в тлг](https://t.me/effector_ru)
  - Мемы: доказательство тривиально и предоставляется слушателю https://2ch.pm/ch/src/1/15144575254230.jpg, [effector promo](https://t.me/effector_ru/26937)
  - Об авторе и ментейнерах, баз фактор
- Про СТМ (стейт-менеджер) в целом
  - Global shared object -> DataBase (transactions) -> state-manager (reactions)
  - Множество абстракций не заметны
  - [Remove "Redux itself is very simple"](https://github.com/reduxjs/redux/pull/2950)
  - Проблемы или необходимые обязанности:
    - производительный (компиляция / инициализация / реакция)
    - поддержка статической типизации
    - маленький вес
    - простая абстракция
    - легкая расширяемость (push > pull)
    - удобный дебаг (DevTools)
    - тестируемость
    - DI
    - отсутствие бойлерплейта
    - доставка подписчикам только обновленных данных
    - поддержка es5
    - glitch free (diamond problem)
    - ленивые вычисления
    - хорошие возможности интеграции (symbol-observable)
    - framework-agnostic
    - декларативный == предсказуемый (описание модели и ее мутаций)
    - не удобен для написания плохого кода
    - удобен для написания хорошего кода
    - удобный SSR или управления локальностью (инстансами)
- ^ Redux / Observable / MobX / Effector
- Пример с [displayName](https://codesandbox.io/s/effector-comparison-r9qy2) (diamond problem)
- Under the hood
  - redux-act -> most -> графы (топологическая, тарьян) -> сигналы + leftist heap tree (DAG-free) -> [we are here: Control Flow](http://www.craftinginterpreters.com/contents.html)
- Проблемы
  > все тоже самое что и у **Observable**
  - statefull - сложности с SSR и локальностью
  - не ленивый - течет
  - циклические зависимости и блуждающий `.on`
  - [Throw in reducer is not cancel computation of other reducers](https://github.com/zerobias/effector/issues/90)
  - Стартеры хоть и называются event, но это не про event sourcing
- эффектор многим похож на Observable (и имеет хороший интероп с ними), но сфокусирован не на потоках, а на данных и их зависимостях. В частности есть разделение на два этапа: вычисление всех данных и реакции
  > ядро эффектора оперирует семантикой, в принципе не доступной обсерваблам, ни приоритизации, ни самого понятия побочных эффектов в спеке обсерваблов просто нет (@ZeroBias)
- В отличии от MobX не требует декораторов, классов, прокси, значительно меньше в размере, декларативен (у мобыкса рантайм семантика)

> - префикс `$` означает что в переменной содержится стор (реактивные данные)
> - иммутабельные данные практичнее
> - (вопрос) в Redux-Saga есть очень клевые штуки аля "takeEvery" / "takeLatest", что есть в эффекторе? - эффектор, в первую очередь, про данные (как и редакс), хотя позволяет легко строить поверх событий сложные асинхронные взаимосвязи
> - (вопрос) Где его лучше использовать и когда - везде где не страшен statefull и 15КБ
> - (вопрос) При обновлении участка стора отрабатывают только подписки, связанный с этим участком, или все подписки на стор? - атомарные сторы. - то есть стор нужно держать "плоским"? - Иногда нужна нормализация, но он может быть вложенная

## Материалы

> - https://wiki2.org/en/Reactive_programming
> - http://dist-prog-book.com/chapter/3/message-passing.html
> - http://pchiusano.blogspot.com/2010/01/actors-are-not-good-concurrency-model.html
> - [The introduction to Reactive Programming you've been missing](https://gist.github.com/staltz/868e7e9bc2a7b8c1f754)